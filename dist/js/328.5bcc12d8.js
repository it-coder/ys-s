"use strict";(self["webpackChunkcdm_screen"]=self["webpackChunkcdm_screen"]||[]).push([[328],{9328:function(e,n,t){t.r(n),t.d(n,{default:function(){return g}});t(6229),t(7330),t(2062);var o=t(3396),a=t(7139),i=t(4870);const s="https://www.lscdm.com/jianMoApi/api/open/client/default_player",c="wss://www.lscdm.com/jianMoWs/ws/player",l=e=>((0,o.dD)("data-v-72712605"),e=e(),(0,o.Cn)(),e),r={class:"engine"},d={key:0,class:"current-point"},p=l((()=>(0,o._)("div",{id:"engine",class:"engine-container"},null,-1)));var u={__name:"index",props:{isBackground:{default:!1,type:Boolean},points:{default:()=>[],type:Array}},emits:["onEngineLoaded","onPopClick"],setup(e,{emit:n}){const t=e,l=(0,i.iH)(null),u=(0,i.iH)({});function m(){(0,i.SU)(l).sendMessage({action:"marker.clearAll"})}function v(e){e.map((e=>{const n=e.point;for(let[t,o]of Object.entries(n))n[t]=+o;(0,i.SU)(l).sendMessage({action:"marker.createpop",location:n,payload:JSON.stringify(e),firstlevel:e.type,secondlevel:e.subType,popname:e.pointName||"",fronsize:12,status:0,webuisize:{X:1e3,Y:450},breakdown:!1,hadWebClick:!0,SapacePopHadNoHoverColor:!0,visibleheight:5e3})}))}function g(){fetch(s,{method:"POST"}).then((e=>e.json())).then((e=>{if(0!==e.code||!e.data.token)return;let t=c+"?token="+e.data.token,o=new URLSearchParams(location.search);const a=window.Engine.default;l.value=new a({dom:document.getElementById("engine"),directServer:t,debug:"true"===o.get("debug")}),n("onEngineLoaded",l.value),(0,i.SU)(l).addResponseEventListener("onMessage",(e=>{const t=JSON.parse(e);"PopClick"===t.action&&n("onPopClick",JSON.parse(t.payload)),"MeshClick"===t.action?u.value=t:u.value=null}))})).catch((e=>console.error(e)))}return(0,o.YP)((()=>t.points),(()=>{var e;(null===(e=t.points)||void 0===e?void 0:e.length)>0&&setTimeout((()=>{m(),v(t.points)}),2e3)}),{immediate:!0}),g(),(n,t)=>((0,o.wg)(),(0,o.iD)("div",r,[e.isBackground?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",d,(0,a.zw)(u.value),1)),p]))}},m=t(89);const v=(0,m.Z)(u,[["__scopeId","data-v-72712605"]]);var g=v}}]);
//# sourceMappingURL=328.5bcc12d8.js.map